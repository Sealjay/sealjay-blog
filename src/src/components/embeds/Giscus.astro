---
---

<section class="giscus-wrapper">
  <h2 class="giscus-heading">
    <svg xmlns="http://www.w3.org/2000/svg" class="giscus-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
    </svg>
    Discussion
  </h2>

  <div class="giscus-card">
    <p class="giscus-description">
      Have thoughts or questions? Join the conversation below.
    </p>

    <div class="giscus-container">
      <script
        is:inline
        src="https://giscus.app/client.js"
        data-repo="Sealjay/sealjay-blog"
        data-repo-id="R_kgDOIFGusQ"
        data-category="Comments"
        data-category-id="DIC_kwDOIFGusc4CWbkg"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-theme-dark="dark_dimmed"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async
      ></script>
    </div>
  </div>
</section>

<style>
  .giscus-wrapper {
    margin-top: 3rem;
  }

  .giscus-heading {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--color-text);
    margin-bottom: 1.5rem;
    display: flex;
    align-items: center;
  }

  @media (min-width: 640px) {
    .giscus-heading {
      font-size: 1.5rem;
    }

    .giscus-wrapper {
      margin-top: 4rem;
    }
  }

  .giscus-icon {
    width: 1.5rem;
    height: 1.5rem;
    margin-right: 0.5rem;
    color: var(--color-primary);
  }

  .giscus-card {
    background: var(--color-surface);
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    padding: 1rem;
  }

  @media (min-width: 640px) {
    .giscus-card {
      padding: 1.5rem;
    }
  }

  .giscus-description {
    color: var(--color-text-muted);
    margin-bottom: 1rem;
  }

  /* Ensure the giscus container adapts to mobile screens properly */
  .giscus-container {
    width: 100%;
    overflow: hidden;
  }

  /* Ensure giscus iframe is responsive */
  :global(.giscus-frame) {
    width: 100%;
    border: 0 !important;
  }
</style>

<script>
  // Handle theme changes for giscus using data-theme attribute
  const setupGiscusThemeSync = () => {
    const getTheme = () => {
      return document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark_dimmed' : 'light'
    }

    const updateGiscusTheme = () => {
      const theme = getTheme()
      const iframe = document.querySelector<HTMLIFrameElement>('.giscus-frame')
      if (iframe?.contentWindow) {
        iframe.contentWindow.postMessage(
          {
            giscus: {
              setConfig: {
                theme,
              },
            },
          },
          'https://giscus.app',
        )
      }
    }

    // Watch for the giscus iframe to appear in the DOM
    const bodyObserver = new MutationObserver(() => {
      if (document.querySelector('.giscus-frame')) {
        updateGiscusTheme()
        bodyObserver.disconnect()

        // Now watch for data-theme attribute changes on <html>
        const themeObserver = new MutationObserver((mutations) => {
          for (const mutation of mutations) {
            if (mutation.type === 'attributes' && mutation.attributeName === 'data-theme') {
              updateGiscusTheme()
            }
          }
        })

        themeObserver.observe(document.documentElement, {
          attributes: true,
          attributeFilter: ['data-theme'],
        })
      }
    })

    bodyObserver.observe(document.body, { childList: true, subtree: true })
  }

  // Setup when the DOM is ready
  document.addEventListener('DOMContentLoaded', setupGiscusThemeSync)
</script>

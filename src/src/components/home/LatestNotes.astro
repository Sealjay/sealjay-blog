---
import FormattedDate from '../partials/FormattedDate.astro'

interface NotePreview {
  description?: string
  title?: string
  time: string
  url: string
}

interface Props {
  date: Date
  dayUrl: string
  daySummary?: string
  noteCount: number
  previews: NotePreview[]
}

const { date, dayUrl, daySummary, noteCount, previews } = Astro.props
const overflow = noteCount - previews.length
---

<div class="rounded-xl bg-white/90 dark:bg-zinc-800/70 backdrop-blur ring-1 ring-zinc-200/60 dark:ring-zinc-700/40 px-4 py-3 shadow-sm">
  <div class="flex items-center gap-3 mb-2">
    <span class="shrink-0 inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-300">
      Notes
    </span>
    <span class="text-xs text-zinc-500 dark:text-zinc-400">
      <FormattedDate date={date} /> &middot; {noteCount} {noteCount === 1 ? 'note' : 'notes'}
    </span>
    <a
      href="/notes"
      class="ml-auto text-xs text-accent-600 dark:text-accent-400 hover:text-accent-700 dark:hover:text-accent-300 font-medium transition-colors flex items-center gap-0.5"
    >
      View all notes
      <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </a>
  </div>

  {daySummary && (
    <p class="text-sm text-zinc-600 dark:text-zinc-400 mb-2 italic">
      {daySummary}
    </p>
  )}

  <div class="flex flex-col gap-0.5">
    {previews.map((note) => (
      <a
        href={note.url}
        class="flex items-center gap-2 rounded-lg px-2 py-1 -mx-1 hover:bg-zinc-50 dark:hover:bg-zinc-700/30 transition-colors"
      >
        <span class="text-zinc-400 dark:text-zinc-500 leading-5" aria-hidden="true">&#8226;</span>
        <span class="flex-1 text-sm text-zinc-700 dark:text-zinc-300 truncate leading-5">
          {note.description || note.title || 'Note'}
        </span>
        <span class="shrink-0 text-xs text-zinc-400 dark:text-zinc-500 tabular-nums leading-5">
          {note.time}
        </span>
      </a>
    ))}
    {overflow > 0 && (
      <a
        href={dayUrl}
        class="px-2 py-1 -mx-1 text-xs text-accent-600 dark:text-accent-400 hover:text-accent-700 dark:hover:text-accent-300 transition-colors"
      >
        and {overflow} more &rarr;
      </a>
    )}
  </div>
</div>

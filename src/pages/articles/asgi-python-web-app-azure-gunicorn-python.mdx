import { ArticleLayout } from '@/components/ArticleLayout'

export const meta = {
  author: 'Chris Lloyd-Jones',
  date: '2021-02-09T09:20:00.000Z',
  tags: ['Snippets'],
  title:
    'Running an ASGI Python Web Application in Azure with Gunicorn and Uvicorn',
  slug: 'asgi-python-web-app-azure-gunicorn-python',
}

export default (props) => <ArticleLayout meta={meta} {...props} />

<p>
  Assuming you're using a Linux web application plan, and running a Python
  application that requires the use of Uvicorn, here are some tips.
</p>
<p>
  You'll need to{' '}
  <a href="https://docs.microsoft.com/en-gb/azure/app-service/configure-language-python#customize-startup-command">
    have a startup command set in Azure
  </a>
  , which either calls a Uvicorn worker directly, or calls a configuration file specifying
  one.
</p>
<figure class="kg-card kg-image-card kg-card-hascaption">
  <img
    src="__GHOST_URL__/content/images/2021/02/image-2.png"
    class="kg-image"
    alt
    loading="lazy"
    width="296"
    height="63"
  />
  <figcaption>
    On the Azure Portal, open your Web App, scroll to 'Configuration' under
    'Settings', click on the 'General Settings' tab, and enter the appropriate
    startup command.
  </figcaption>
</figure>
<p>
  <code>gunicorn -c gunicorn_config.py app:app</code>
</p>
<p>
  Once your startup command is set, you'll also need to have a
  gunicorn_config.py file in your web app deployment.
</p>
<pre>
  <code class="language-python">
    # Configuration for Gunicorn on Azure # Azure Startup Command should be:
    gunicorn -c gunicorn_config.py app:app # See:
    https://docs.gunicorn.org/en/stable/settings.html#config workers = 4
    worker_class = &quot;uvicorn.workers.UvicornWorker&quot;
  </code>
</pre>
<p>
  Finally, in your requirements.txt file, you'll need to specify additional
  dependencies:
</p>
<pre>
  <code># Required for deploying to Azure uvicorn uvloop httptools</code>
</pre>
